/*! g3 - v0.0.1 - 2015-10-01 - justinkheisler */
"use strict";(function(t){function i(){var t={};return t}function s(t,i,s,r){return d3.svg.axis().scale(t).innerTickSize(i).outerTickSize(3).tickPadding(5).orient(s).ticks(r)}"undefined"==typeof g3&&(t.g3=i()),g3.canvas=function(t,i){return new r(t,i)};var r=function r(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._canvas=d3.select(this._plot.elem).append("canvas").attr("width",this._data.length).attr("height",this._data[0].length).style("width",this._plot.width+"px").style("height",this._plot.height+"px").style("opacity",.95).style("top",this._plot.margin.top+"px").style("left",this._plot.margin.left+"px"),this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};r.prototype.style={},r.prototype.style.opacity=function(t){return this._style._opacity=t,this._canvas.style("opacity",t),this},r.prototype.gain=function(t){return this._gain=t,this},r.prototype.colorScale=function(t){return this._colorScale=t,this},r.prototype.draw=function(){return this._context=this._canvas.node().getContext("2d"),this.drawImage(),this},r.prototype.reDraw=function(t){return this._context.clearRect(0,0,this._data.length,this._data[0].length),this._canvas.attr("width",t.length).attr("height",t[0].length),this._data=t,this.drawImage(),this},r.prototype.drawImage=function(){var t=this._data.length,i=this._data[0].length;this._image=this._context.createImageData(t,i);for(var s=0,r=-1;i>s;++s)for(var n=0;t>n;++n){var e=d3.rgb(this._colorScale(this._data[n][s]*this._gain));this._image.data[++r]=e.r,this._image.data[++r]=e.g,this._image.data[++r]=e.b,this._image.data[++r]=255}return this._context.putImageData(this._image,0,0),this},g3.horizon=function(t,i){return new n(t,i)};var n=function n(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._xMin=t.xDomain[0],this._yMin=t.yDomain[0],this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};n.prototype._xInt=1,n.prototype._yInt=1,n.prototype._duration=500,n.prototype._gain=1,n.prototype._interpolate="basis",n.prototype._color="green",n.prototype._strokeWidth=1.5,n.prototype.interpolate=function(t){return this._interpolate=t,this},n.prototype.xMin=function(t){return this._xMin=t,this},n.prototype.yMin=function(t){return this._yMin=t,this},n.prototype.xInt=function(t){return this._xInt=t,this},n.prototype.yInt=function(t){return this._yInt=t,this},n.prototype.duration=function(t){return this._duration=t,this},n.prototype.gain=function(t){return this._gain=t,this},n.prototype.color=function(t){return this._color=t,this},n.prototype.strokeWidth=function(t){return this._strokeWidth=t,this},n.prototype.lineFunc=function(){var t=this._plot,i=this._xMin,s=this._gain,r=this._interpolate,n=d3.svg.line().x(function(s,r){return t.xScale(r+i)}).y(function(i){return t.yScale(i*s)}).interpolate(r);return n},n.prototype.draw=function(){var t=this.lineFunc();return this._svg=this._plot.svg.append("path").attr("d",t(this._data)).attr("stroke",this._color).attr("stroke-width",this._strokeWidth).attr("fill","none"),this},n.prototype.reDraw=function(t){var i=this.lineFunc();return this._svg.transition().duration(this._duration).attr("d",i(t)),this},g3.log=function(t,i){return new e(t,i)};var e=function e(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._xMin=t.xDomain[0],this._yMin=t.yDomain[0],this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};e.prototype._xInt=1,e.prototype._yInt=1,e.prototype._color="blue",e.prototype._duration=5,e.prototype._strokeWidth=.25,e.prototype.duration=function(t){return this._duration=t,this},e.prototype.xMin=function(t){return this._xMin=t,this},e.prototype.xInt=function(t){return this._xInt=t,this},e.prototype.yMin=function(t){return this._yMin=t,this},e.prototype.yInt=function(t){return this._yInt=t,this},e.prototype.color=function(t){return this._color=t,this},e.prototype.strokeWidth=function(t){return this._strokeWidth=t,this},e.prototype.draw=function(){var t=this.lineFunc();return this._svg=this._plot.svg.append("path").datum(this._data).attr("d",t).attr("stroke",this._color).attr("stroke-width",this._strokeWidth).attr("fill","none"),this},e.prototype.reDraw=function(t){var i=this.lineFunc();return this._svg.transition().duration(this._duration).attr("d",i(t)).ease("linear"),this},e.prototype.lineFunc=function(){var t=this._plot,i=this._yInt,s=this._yMin,r=this._interpolate;return d3.svg.line().x(function(i){return t.xScale(i)}).y(function(r,n){return t.yScale(n*i+s)}).interpolate(r)},g3.plot=function(t){if(!t)return"Param: elem is missing. A div to attach to is required";var i={};return i.margin={top:50,right:0,bottom:30,left:0},i.width=$(t).width()-i.margin.left,i.height=800,i.xDomain=[0,0],i.yDomain=[0,0],i.elem=t,i.xAxisVisible=!0,i.yAxisVisible=!0,i.x2AxisVisible=!1,i.y2AxisVisible=!1,i.xOrient="top",i.x2Orient="bottom",i.yOrient="left",i.y2Orient="right",i.duration=500,i.setDuration=function(t){return this.duration=t,this},i.setMargin=function(t,i,s,r){return this.margin={top:t,right:i,bottom:s,left:r},this},i.setWidth=function(t){return this.width=t,this},i.setHeight=function(t){return this.height=t,this},i.setXDomain=function(t){return this.xDomain=t,this},i.setYDomain=function(t){return this.yDomain=t,this},i.setX2Domain=function(t){return this.x2Domain=t,this},i.setY2Domain=function(t){return this.y2Domain=t,this},i.toggleXAxis=function(t){return this.xAxisVisible=t,this},i.toggleX2Axis=function(t){return this.x2AxisVisible=t,this},i.toggleYAxis=function(t){return this.yAxisVisible=t,this},i.toggleY2Axis=function(t){return this.y2AxisVisible=t,this},i.setXTicks=function(t){return this.xTicks=t,this},i.setYTicks=function(t){return this.yTicks=t,this},i.setX2Ticks=function(t){return this.x2Ticks=t,this},i.setY2Ticks=function(t){return this.y2Ticks=t,this},i.setYTitle=function(t){return this.yTitle=t,this},i.setXTitle=function(t){return this.xTitle=t,this},i.setY2Title=function(t){return this.y2Title=t,this},i.setX2Title=function(t){return this.x2Title=t,this},i.setXOrient=function(t){return this.xOrient=t,this},i.setX2Orient=function(t){return this.x2Orient=t,this},i.setYOrient=function(t){return this.yOrient=t,this},i.sety2Orient=function(t){return this.y2Orient=t,this},i.setXTickFormat=function(t){return this.xTickFormat=t,this},i.setYTickFormat=function(t){return this.yTickFormat=t,this},i.setX2TickFormat=function(t){return this.x2TickFormat=t,this},i.setY2TickFormat=function(t){return this.y2TickFormat=t,this},i.draw=function(){if(this.xScale=d3.scale.linear().domain(this.xDomain).range([0,this.width]),this.yScale=d3.scale.linear().domain(this.yDomain).range([0,this.height]),this.width-this.margin.left-this.margin.right,this.height-this.margin.top-this.margin.bottom,this.svg=d3.select(t).append("svg").attr("class","log_plot").attr("width",this.width+this.margin.right+this.margin.left).attr("height",this.height+this.margin.bottom+this.margin.top).append("g").attr("height",this.height).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.xAxisVisible&&(this.xAxis=s(this.xScale,-this.height,this.xOrient,this.xTicks),this.xAxis.tickFormat(this.xTickFormat),this.svg.append("g").attr("class","x axis").call(this.xAxis)),this.yAxisVisible&&(this.yAxis=s(this.yScale,-this.width,this.yOrient,this.yTicks),this.yAxis.tickFormat(this.yTickFormat),this.svg.append("g").attr("class","y axis").call(this.yAxis)),this.x2AxisVisible&&(this.x2Scale=d3.scale.linear().domain(this.x2Domain).range([0,this.width]),this.x2Axis=s(this.x2Scale,-this.height,this.x2Orient,this.x2Ticks),this.x2Axis.tickFormat(this.x2TickFormat),this.svg.append("g").attr("class","x2 axis").attr("transform","translate(0,"+this.height+")").call(this.x2Axis)),this.y2AxisVisible&&(this.y2Scale=d3.scale.linear().domain(this.y2Domain).range([0,this.height]),this.y2Axis=s(this.y2Scale,-this.width,this.y2Orient,this.y2Ticks),this.y2Axis.tickFormat(this.y2TickFormat),this.svg.append("g").attr("class","y2 axis").attr("transform","translate("+this.width+",0)").call(this.y2Axis)),this.xTitle){if(""===this.xTickFormat)var i=-10;else var i=-30;this.svg.append("text").attr("x",this.width/2).attr("y",i).style("text-anchor","middle").style("font-size",12).text(this.xTitle)}if(this.yTitle){if(""===this.yTickFormat)var r=-10;else var r=-40;this.svg.append("text").attr("transform","rotate(-90)").attr("y",r).attr("dy","1em").style("text-anchor","end").style("font-size",12).text(this.yTitle)}if(this.x2Title){if(""===this.x2TickFormat)var i=10;else var i=30;this.svg.append("text").attr("transform","translate(0,"+this.height+")").attr("x",this.width/2).attr("y",i).style("text-anchor","middle").style("font-size",12).text(this.x2Title)}if(this.y2Title){if(""===this.yTickFormat)var r=-10;else var r=-40;this.svg.append("text").attr("transform","translate(0,"+this.height+")").attr("y",r).attr("dy","1em").style("text-anchor","end").style("font-size",12).text(this.y2Title)}return this},i.reDraw=function(t,i,s,r){t&&(this.xScale.domain(t),this.svg.select(".x.axis").transition().duration(this.duration).call(this.xAxis).ease("linear")),i&&(this.yScale.domain(i),this.svg.select(".y.axis").transition().duration(this.duration).call(this.yAxis).ease("linear")),s&&(this.x2Scale.domain(s),this.svg.select(".x2.axis").transition().duration(this.duration).call(this.x2Axis).ease("linear")),r&&(this.y2Scale.domain(r),this.svg.select(".y2.axis").transition().duration(this.duration).call(this.y2Axis).ease("linear"))},i},g3.seismic=function(t,i){return new a(t,i)};var a=function a(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};a.prototype._max=1,a.prototype._gain=1,a.prototype._duration=5,void 0===a._colorScale&&(a.prototype._colorScale=function(){return d3.scale.linear().domain([-this._max,0,this._max]).range(["#FF0000","#FFFFFF","#0000FF"])}),a.prototype.colorScale=function(t){return this._colorScale=t,this},a.prototype.duration=function(t){return this._duration=t,this},a.prototype.gain=function(t){return this._gain=t,this},a.prototype.max=function(t){return this._max=t,this},a.prototype.draw=function(){return this._canvas=g3.canvas(this._plot,this._data).gain(this._gain).colorScale(this._colorScale).draw(),this},a.prototype.reDraw=function(t){this._canvas.reDraw(t)},g3.wiggle=function(t,i){return new o(t,i)};var o=function o(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._xMin=t.xDomain[0],this._yMin=t.yDomain[0],this._rand=Math.floor(100*Math.random()+100),this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};o.prototype._skip=0,o.prototype._gain=30,o.prototype._xInt=1,o.prototype._yInt=1,o.prototype._duration=5,o.prototype._sampleRate=1,o.prototype._strokeWidth=.5,o.prototype._color="black",o.prototype._fillColor="black",o.prototype._opacity=.4,o.prototype.skip=function(t){return this._skip=t,this},o.prototype.gain=function(t){return this._gain=t,this},o.prototype.max=function(t){return this._max=t,this},o.prototype.xMin=function(t){return this._xMin=t,this},o.prototype.yMin=function(t){return this._yMin=t,this},o.prototype.xInt=function(t){return this._xInt=t,this},o.prototype.yInt=function(t){return this._yInt=t,this},o.prototype.fillColor=function(t){return this._fillColor=t,this},o.prototype.color=function(t){return this._color=t,this},o.prototype.strokeWidth=function(t){return this._strokeWidth=t,this},o.prototype.sampleRate=function(t){return this._sampleRate=t,this},o.prototype.duration=function(t){return this._duration=t,this},o.prototype.opacity=function(t){return this._opacity=t,this},o.prototype.lineFunc=function(t){var i=this._plot,s=this._gain,r=this._xMin,n=this._sampleRate,e=this._yInt,a=this._yMin;return d3.svg.area().x(function(e){return i.xScale(e*s+r+t*n)}).y(function(t,s){return i.yScale(s*e+a)}).interpolate("basis")},o.prototype.areaFunc=function(t,i){var s=this._plot,r=this._gain,n=this._xMin,e=this._sampleRate,a=this._yMin,o=this._yInt;return d3.svg.area().x(function(){return s.xScale(i*r+n+t*e)}).y(function(t,i){return s.yScale(i*o+a)}).interpolate("basis")},o.prototype.draw=function(){for(var t=this._data.length-1;t>=0;t--)if(0===this._skip||0===t%this._skip){var i=d3.mean(this._data[t]),s=this.lineFunc(t),r=this.areaFunc(t,i);this._plot.svg.datum(this._data[t]),this._plot.svg.append("clipPath").attr("id","clip-below"+this._rand+t).append("path").attr("d",r.x0(this._plot.width));var n=this._plot,e=this._gain,a=this._xMin,o=this._sampleRate;this._plot.svg.append("path").attr("id","area-below"+t).attr("clip-path","url(#clip-below"+this._rand+t).attr("fill",this._fillColor).style("opacity",this._opacity).attr("d",r.x0(function(i){return n.xScale(i*e+a+t*o)})),this._plot.svg.append("path").attr("class","line"+t).attr("d",s(this._data[t])).attr("stroke",this._color).attr("stroke-width",this._strokeWidth).attr("fill","none")}return this},o.prototype.reDraw=function(t,i,s){this._plot.xScale.domain(i),this._plot.yScale.domain(s),this._plot.svg.select(".x.axis").transition().duration(this._duration).call(this._plot.xAxis).selectAll("text").style("text-anchor","start").attr("transform","rotate(-45)"),this._plot.svg.select(".y.axis").transition().duration(this._duration).call(this._plot.yAxis);for(var r=t.length-1;r>=0;r--)if(0===this._skip||0===r%this._skip){var n=d3.mean(t[r]);this._plot.svg.select("#clip-below"+this._rand+r).remove();var e=this.lineFunc(r),a=this.areaFunc(r,n);this._plot.svg.select(".line"+r).transition().duration(this._duration).attr("d",e(t[r])).ease("linear"),this._plot.svg.datum(t[r]),this._plot.svg.append("clipPath").attr("id","clip-below"+this._rand+r).append("path").attr("d",a.x0(this._plot.width));var o=this._plot,h=this._gain,l=this._xMin,p=this._sampleRate;this._plot.svg.select("#area-below"+r).attr("clip-path","url(#clip-below"+this._rand+r).transition().duration(this._duration).attr("d",a.x0(function(t){return o.xScale(t*h+l+r*p)})).ease("linear")}return this}})(window);