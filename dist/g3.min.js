/*! g3 - v0.0.1 - 2015-10-01 - justinkheisler */
"use strict";(function(t){function i(){var t={};return t}"undefined"==typeof g3&&(t.g3=i()),g3.canvas=function(t,i){return new s(t,i)};var s=function s(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._canvas=d3.select(this._plot.elem).append("canvas").attr("width",this._data.length).attr("height",this._data[0].length).style("width",this._plot.width+"px").style("height",this._plot.height+"px").style("opacity",.95).style("top",this._plot.margin.top+"px").style("left",this._plot.margin.left+"px"),this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};s.prototype.style={},s.prototype.style.opacity=function(t){return void 0===t?this._style._opacity:(this._style._opacity=t,this._canvas.style("opacity",t),this)},s.prototype.gain=function(t){return void 0===t?this._gain:(this._gain=t,this)},s.prototype.colorScale=function(t){return void 0===t?this._colorScale:(this._colorScale=t,this)},s.prototype.draw=function(){return this._context=this._canvas.node().getContext("2d"),this.drawImage(),this},s.prototype.reDraw=function(t){return this._context.clearRect(0,0,this._data.length,this._data[0].length),this._canvas.attr("width",t.length).attr("height",t[0].length),this._data=t,this.drawImage(),this},s.prototype.drawImage=function(){var t=this._data.length,i=this._data[0].length;this._image=this._context.createImageData(t,i);for(var s=0,o=-1;i>s;++s)for(var r=0;t>r;++r){var n=d3.rgb(this._colorScale(this._data[r][s]*this._gain));this._image.data[++o]=n.r,this._image.data[++o]=n.g,this._image.data[++o]=n.b,this._image.data[++o]=255}return this._context.putImageData(this._image,0,0),this},g3.horizon=function(t,i){return new o(t,i)};var o=function o(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._xMin=t.xDomain[0],this._yMin=t.yDomain[0],this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};o.prototype._xInt=1,o.prototype._yInt=1,o.prototype._duration=500,o.prototype._gain=1,o.prototype._interpolate="basis",o.prototype._color="green",o.prototype._strokeWidth=1.5,o.prototype.interpolate=function(t){return void 0===t?this._interpolate:(this._interpolate=t,this)},o.prototype.xMin=function(t){return void 0===t?this._xMin:(this._xMin=t,this)},o.prototype.yMin=function(t){return void 0===t?this._yMin:(this._yMin=t,this)},o.prototype.xInt=function(t){return void 0===t?this._xInt:(this._xInt=t,this)},o.prototype.yInt=function(t){return void 0===t?this._yInt:(this._yInt=t,this)},o.prototype.duration=function(t){return void 0===t?this._duration:(this._duration=t,this)},o.prototype.gain=function(t){return void 0===t?this._gain:(this._gain=t,this)},o.prototype.color=function(t){return void 0===t?this._color:(this._color=t,this)},o.prototype.strokeWidth=function(t){return void 0===t?this._strokeWidth:(this._strokeWidth=t,this)},o.prototype.lineFunc=function(){var t=this._plot,i=this._xMin,s=this._gain,o=this._interpolate,r=d3.svg.line().x(function(s,o){return t.xScale(o+i)}).y(function(i){return t.yScale(i*s)}).interpolate(o);return r},o.prototype.draw=function(){var t=this.lineFunc();return this._svg=this._plot.svg.append("path").attr("d",t(this._data)).attr("stroke",this._color).attr("stroke-width",this._strokeWidth).attr("fill","none"),this},o.prototype.reDraw=function(t){var i=this.lineFunc();return this._svg.transition().duration(this._duration).attr("d",i(t)),this},g3.log=function(t,i){return new r(t,i)};var r=function r(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._xMin=t.xDomain[0],this._yMin=t.yDomain[0],this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};r.prototype._xInt=1,r.prototype._yInt=1,r.prototype._color="blue",r.prototype._duration=5,r.prototype._strokeWidth=.25,r.prototype.duration=function(t){return void 0===t?this._duration:(this._duration=t,this)},r.prototype.xMin=function(t){return void 0===t?this._xMin:(this._xMin=t,this)},r.prototype.xInt=function(t){return void 0===t?this._xInt:(this._xInt=t,this)},r.prototype.yMin=function(t){return void 0===t?this._yMin:(this._yMin=t,this)},r.prototype.yInt=function(t){return void 0===t?this._yInt:(this._yInt=t,this)},r.prototype.color=function(t){return void 0===t?this._color:(this._color=t,this)},r.prototype.strokeWidth=function(t){return void 0===t?this._strokeWidth:(this._strokeWidth=t,this)},r.prototype.draw=function(){var t=this.lineFunc();return this._svg=this._plot.svg.append("path").datum(this._data).attr("d",t).attr("stroke",this._color).attr("stroke-width",this._strokeWidth).attr("fill","none"),this},r.prototype.reDraw=function(t){var i=this.lineFunc();return this._svg.transition().duration(this._duration).attr("d",i(t)).ease("linear"),this},r.prototype.lineFunc=function(){var t=this._plot,i=this._yInt,s=this._yMin,o=this._interpolate;return d3.svg.line().x(function(i){return t.xScale(i)}).y(function(o,r){return t.yScale(r*i+s)}).interpolate(o)},g3.plot=function(t){return new n(t)};var n=function n(t){return t?(this._elem=t,this._margin={top:50,right:0,bottom:30,left:0},this._width=$(this._elem).width()-this._margin.left,this):"Param: elem is missing. A div to attach to is required"};n.prototype._height=800,n.prototype._xDomain=[0,0],n.prototype._yDomain=[0,0],n.prototype._xAxisVisible=!0,n.prototype._yAxisVisible=!0,n.prototype._x2AxisVisible=!0,n.prototype._y2AxisVisible=!0,n.prototype._xOrient="top",n.prototype._x2Orient="bottom",n.prototype._yOrient="left",n.prototype._y2Orient="right",n.prototype._duration=5,n.prototype.duration=function(t){return void 0===t?this._duration:(this._duration=t,this)},n.prototype.margin=function(t,i,s,o){return void 0===t?this._margin:(this._margin={top:t,right:i,bottom:s,left:o},this)},n.prototype.width=function(t){return void 0===t?this._width:(this._width=t,this)},n.prototype.height=function(t){return void 0===t?this._height:(this._height=t,this)},n.prototype.xDomain=function(t){return void 0===t?this._xDomain:(this._xDomain=t,this)},n.prototype.yDomain=function(t){return void 0===t?this._yDomain:(this._yDomain=t,this)},n.prototype.y2Domain=function(t){return void 0===t?this._y2Domain:(this._x2Domain=t,this)},n.prototype.y2Domain=function(t){return void 0===t?this._y2Domain:(this._y2Domain=t,this)},n.prototype.toggleXAxis=function(t){return void 0===t?this._xAxisVisible:(this._xAxisVisible=t,this)},n.prototype.toggleX2Axis=function(t){return void 0===t?this._x2AxisVisible:(this._x2AxisVisible=t,this)},n.prototype.toggleYAxis=function(t){return void 0===t?this._yAxisVisible:(this._yAxisVisible=t,this)},n.prototype.toggleY2Axis=function(t){return void 0===t?this._y2AxisVisible:(this._y2AxisVisible=t,this)},n.prototype.xTicks=function(t){return void 0===t?this._xTicks:(this._xTicks=t,this)},n.prototype.yTicks=function(t){return void 0===t?this._yTicks:(this._yTicks=t,this)},n.prototype.x2Ticks=function(t){return void 0===t?this._x2Ticks:(this._x2Ticks=t,this)},n.prototype.y2Ticks=function(t){return void 0===t?this._y2Ticks:(this._y2Ticks=t,this)},n.prototype.xTitle=function(t){return void 0===t?this._yTitle:(this._xTitle=t,this)},n.prototype.yTitle=function(t){return void 0===t?this._yTitle:(this._yTitle=t,this)},n.prototype.y2Title=function(t){return void 0===t?this._y2Title:(this._y2Title=t,this)},n.prototype.x2Title=function(t){return void 0===t?this._x2Title:(this._x2Title=t,this)},n.prototype.xOrient=function(t){return void 0===t?this._xOrient:(this._xOrient=t,this)},n.prototype.x2Orient=function(t){return void 0===t?this._x2Orient:(this._x2Orient=t,this)},n.prototype.yOrient=function(t){return void 0===t?this._yOrient:(this._yOrient=t,this)},n.prototype.y2Orient=function(t){return void 0===t?this._y2Orient:(this._y2Orient=t,this)},n.prototype.xTickFormat=function(t){return void 0===t?this._xTickFormat:(this._xTickFormat=t,this)},n.prototype.yTickFormat=function(t){return void 0===t?this._yTickFormat:(this._yTickFormat=t,this)},n.prototype.x2TickFormat=function(t){return void 0===t?this._x2TickFormat:(this._x2TickFormat=t,this)},n.prototype.y2TickFormat=function(t){return void 0===t?this._y2TickFormat:(this._y2TickFormat=t,this)},n.prototype.createSVG=function(){return d3.select(this._elem).append("svg").attr("class","log_plot").attr("width",this._width+this._margin.right+this._margin.left).attr("height",this._height+this._margin.bottom+this._margin.top).append("g").attr("height",this.height).attr("transform","translate("+this._margin.left+","+this._margin.top+")")},n.prototype.setScales=function(){this._xScale=d3.scale.linear().domain(this._xDomain).range([0,this._width]),this._yScale=d3.scale.linear().domain(this._yDomain).range([0,this._height]),void 0===this._x2Domain&&(this._x2Domain=this._xDomain),this._x2Scale=d3.scale.linear().domain(this._x2Domain).range([0,this._width]),void 0===this._y2Domain&&(this._y2Domain=this._yDomain),this._y2Scale=d3.scale.linear().domain(this._y2Domain).range([0,this._height])},n.prototype.createAxis=function(t,i,s,o){return d3.svg.axis().scale(t).innerTickSize(i).outerTickSize(3).tickPadding(5).orient(s).ticks(o)},n.prototype.setAxis=function(){this._xAxisVisible&&(this._xAxis=this.createAxis(this._xScale,-this._height,this._xOrient,this._xTicks),this._xTickFormat&&this._xAxis.tickFormat(this._xTickFormat),this._svg.append("g").attr("class","x axis").call(this._xAxis)),this._yAxisVisible&&(this._yAxis=this.createAxis(this._yScale,-this._width,this._yOrient,this._yTicks),this._yTickFormat&&this._yAxis.tickFormat(this._yTickFormat),this._svg.append("g").attr("class","y axis").call(this._yAxis)),this._x2AxisVisible&&(this._x2Axis=this.createAxis(this._x2Scale,-this._height,this._x2Orient,this._x2Ticks),this._x2AxisFormat&&this._x2Axis.tickFormat(this._x2TickFormat),this._svg.append("g").attr("class","x2 axis").attr("transform","translate(0,"+this._height+")").call(this._x2Axis)),this._y2AxisVisible&&(this._y2Axis=this.createAxis(this._y2Scale,-this._width,this._y2Orient,this._y2Ticks),this._y2AxisFormat&&this._y2Axis.tickFormat(this._y2TickFormat),this._svg.append("g").attr("class","y2 axis").attr("transform","translate("+this._width+",0)").call(this._y2Axis))},n.prototype.setTitles=function(){if(this._xTitle){if(""===this._xTickFormat)var t=-10;else var t=-30;this._svg.append("text").attr("x",this._width/2).attr("y",t).style("text-anchor","middle").style("font-size",12).text(this._xTitle)}if(this._yTitle){if(""===this._yTickFormat)var i=-10;else var i=-40;this._svg.append("text").attr("transform","rotate(-90)").attr("y",i).attr("dy","1em").style("text-anchor","end").style("font-size",12).text(this._yTitle)}if(this._x2Title){if(""===this._x2TickFormat)var t=10;else var t=30;this._svg.append("text").attr("transform","translate(0,"+this._height+")").attr("x",this._width/2).attr("y",t).style("text-anchor","middle").style("font-size",12).text(this._x2Title)}if(this._y2Title){if(""===this._yTickFormat)var i=-10;else var i=-40;this._svg.append("text").attr("transform","translate(0,"+this._height+")").attr("y",i).attr("dy","1em").style("text-anchor","end").style("font-size",12).text(this._y2Title)}},n.prototype.draw=function(){return this.setScales(),this._svg=this.createSVG(),this.setAxis(),this.setTitles(),this},n.prototype.reDraw=function(t,i,s,o){t&&(this._xScale.domain(t),this._svg.select(".x.axis").transition().duration(this._duration).call(this._xAxis).ease("linear")),i&&(this._yScale.domain(i),this._svg.select(".y.axis").transition().duration(this._duration).call(this._yAxis).ease("linear")),s&&(this._x2Scale.domain(s),this._svg.select(".x2.axis").transition().duration(this._duration).call(this._x2Axis).ease("linear")),o&&(this._y2Scale.domain(o),this._svg.select(".y2.axis").transition().duration(this._duration).call(this._y2Axis).ease("linear"))},g3.seismic=function(t,i){return new e(t,i)};var e=function e(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};e.prototype._max=1,e.prototype._gain=1,e.prototype._duration=5,void 0===e._colorScale&&(e.prototype._colorScale=function(){return d3.scale.linear().domain([-this._max,0,this._max]).range(["#FF0000","#FFFFFF","#0000FF"])}),e.prototype.colorScale=function(t){return void 0===t?this._colorScale:(this._colorScale=t,this)},e.prototype.duration=function(t){return void 0===t?this._duration:(this._duration=t,this)},e.prototype.gain=function(t){return void 0===t?this._gain:(this._gain=t,this)},e.prototype.max=function(t){return void 0===t?this._max:(this._max=t,this)},e.prototype.draw=function(){return this._canvas=g3.canvas(this._plot,this._data).gain(this._gain).colorScale(this._colorScale).draw(),this},e.prototype.reDraw=function(t){this._canvas.reDraw(t)},g3.wiggle=function(t,i){return new a(t,i)};var a=function a(t,i){return i&&$.isArray(i)?t?(this._data=i,this._plot=t,this._xMin=t.xDomain[0],this._yMin=t.yDomain[0],this._rand=Math.floor(100*Math.random()+100),this):"Param: plot is missing, a div to attach the svg is required":"Param: data is missing, An array required"};a.prototype._skip=0,a.prototype._gain=30,a.prototype._xInt=1,a.prototype._yInt=1,a.prototype._duration=5,a.prototype._sampleRate=1,a.prototype._strokeWidth=.5,a.prototype._color="black",a.prototype._fillColor="black",a.prototype._opacity=.4,a.prototype.skip=function(t){return void 0===t?this._skip:(this._skip=t,this)},a.prototype.gain=function(t){return void 0===t?this._gain:(this._gain=t,this)},a.prototype.max=function(t){return void 0===t?this._max:(this._max=t,this)},a.prototype.xMin=function(t){return void 0===t?this._xMin:(this._xMin=t,this)},a.prototype.yMin=function(t){return void 0===t?this._yMin:(this._yMin=t,this)},a.prototype.xInt=function(t){return void 0===t?this._xInt:(this._xInt=t,this)},a.prototype.yInt=function(t){return void 0===t?this._yInt:(this._yInt=t,this)},a.prototype.fillColor=function(t){return void 0===t?this._fillColor:(this._fillColor=t,this)},a.prototype.color=function(t){return void 0===t?this._color:(this._color=t,this)},a.prototype.strokeWidth=function(t){return void 0===t?this._strokeWidth:(this._strokeWidth=t,this)},a.prototype.sampleRate=function(t){return void 0===t?this._sampleRate:(this._sampleRate=t,this)},a.prototype.duration=function(t){return void 0===t?this._duration:(this._duration=t,this)},a.prototype.opacity=function(t){return void 0===t?this._opacity:(this._opacity=t,this)},a.prototype.lineFunc=function(t){var i=this._plot,s=this._gain,o=this._xMin,r=this._sampleRate,n=this._yInt,e=this._yMin;return d3.svg.area().x(function(n){return i._xScale(n*s+o+t*r)}).y(function(t,s){return i._yScale(s*n+e)}).interpolate("basis")},a.prototype.areaFunc=function(t,i){var s=this._plot,o=this._gain,r=this._xMin,n=this._sampleRate,e=this._yMin,a=this._yInt;return d3.svg.area().x(function(){return s._xScale(i*o+r+t*n)}).y(function(t,i){return s._yScale(i*a+e)}).interpolate("basis")},a.prototype.draw=function(){for(var t=this._data.length-1;t>=0;t--)if(0===this._skip||0===t%this._skip){var i=d3.mean(this._data[t]),s=this.lineFunc(t),o=this.areaFunc(t,i);this._plot._svg.datum(this._data[t]),this._plot._svg.append("clipPath").attr("id","clip-below"+this._rand+t).append("path").attr("d",o.x0(this._plot._width));var r=this._plot,n=this._gain,e=this._xMin,a=this._sampleRate;this._plot._svg.append("path").attr("id","area-below"+t).attr("clip-path","url(#clip-below"+this._rand+t).attr("fill",this._fillColor).style("opacity",this._opacity).attr("d",o.x0(function(i){return r._xScale(i*n+e+t*a)})),this._plot._svg.append("path").attr("class","line"+t).attr("d",s(this._data[t])).attr("stroke",this._color).attr("stroke-width",this._strokeWidth).attr("fill","none")}return this},a.prototype.reDraw=function(t,i,s){this._plot._xScale.domain(i),this._plot._yScale.domain(s),this._plot._svg.select(".x.axis").transition().duration(this._duration).call(this._plot._xAxis).selectAll("text").style("text-anchor","start").attr("transform","rotate(-45)"),this._plot._svg.select(".y.axis").transition().duration(this._duration).call(this._plot._yAxis);for(var o=t.length-1;o>=0;o--)if(0===this._skip||0===o%this._skip){var r=d3.mean(t[o]);this._plot._svg.select("#clip-below"+this._rand+o).remove();var n=this.lineFunc(o),e=this.areaFunc(o,r);this._plot._svg.select(".line"+o).transition().duration(this._duration).attr("d",n(t[o])).ease("linear"),this._plot._svg.datum(t[o]),this._plot._svg.append("clipPath").attr("id","clip-below"+this._rand+o).append("path").attr("d",e.x0(this._plot._width));var a=this._plot,h=this._gain,_=this._xMin,p=this._sampleRate;this._plot._svg.select("#area-below"+o).attr("clip-path","url(#clip-below"+this._rand+o).transition().duration(this._duration).attr("d",e.x0(function(t){return a._xScale(t*h+_+o*p)})).ease("linear")}return this}})(window);