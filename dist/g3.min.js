/*! g3 - v0.0.1 - 2015-09-15 - justinkheisler */
"use strict";(function(t){function i(){var t={};return t}function n(t,i,n,a){return d3.svg.axis().scale(t).innerTickSize(i).outerTickSize(3).tickPadding(5).orient(n).ticks(a)}"undefined"==typeof g3&&(t.g3=i()),g3.horizon=function(t,i,n){if(!i||!$.isArray(i))return"Param: data is missing, An array required";if(!t)return"Param: plot is missing, a div to attach the svg is required";var a={};return a.interpolate="basis",a.xInt=1,a.xMin=t.xDomain[0],a.yInt=1,a.yMin=t.yDomain[0],a.duration=500,n&&(n.interpolate&&(a.interpolate=n.interpolate),n.xInt&&(a.xInt=n.xInt),n.xMin&&(a.xMin=n.xMin),n.yInt&&(a.yInt=n.yInt),n.yMin&&(a.yMin=n.yMin)),a.setInterpolate=function(t){return this.interpolate=t,this},a.setXMin=function(t){return this.xMin=t,this},a.setDuration=function(t){return this.duration=t,this},a.draw=function(){var n=d3.svg.line().x(function(i,n){return t.xScale(n+a.xMin)}).y(function(i){return t.yScale(i)}).interpolate(this.interpolate);return this.svg=t.svg.append("svg:path").attr("d",n(i)).attr("stroke","green").attr("stroke-width",1).attr("fill","none"),this},a.reDraw=function(i){var n=d3.svg.line().x(function(i,n){return t.xScale(n+a.xMin)}).y(function(i){return t.yScale(i)}).interpolate(this.interpolate);return this.svg.transition().duration(this.duration).attr("d",n(i)),this},a},g3.log=function(t,i,n){if(!i||!$.isArray(i))return"Param: data is missing, An array required";if(!t)return"Param: plot is missing, a div to attach the svg is required";var a={};a.xInt=1,a.xMin=t.xDomain[0],a.yInt=1,a.yMin=t.yDomain[0],a.color="blue",a.duration=500,n&&(n.yInt&&(a.yInt=n.zInt),n.yMin&&(a.yMin=n.yMin),n.xInt&&(a.xInt=n.xInt),n.xMin&&(a.xMin=n.xMin)),a.setDuration=function(t){return this.duration=t,this},a.setYInt=function(t){return this.yInt=t,this},a.setYMin=function(t){return this.yMin=t,this},a.setXInt=function(t){return this.xInt=t,this},a.setXMin=function(t){return this.xMin=t,this},a.setData=function(t){return this.data=t,this},a.setColor=function(t){return this.color=t,this},a.draw=function(){return this.svg=t.svg.append("path").datum(i).attr("d",r).attr("stroke",this.color).attr("stroke-width",.25).attr("fill","none"),this};var r=d3.svg.line().x(function(i){return t.xScale(i)}).y(function(i,n){return t.yScale(n*a.yInt+a.yMin)}).interpolate("basis");return a.reDraw=function(t){return this.svg.transition().duration(this.duration).attr("d",r(t)).ease("linear"),this},a},g3.plot=function(t,i){if(!t)return"Param: elem is missing. A div to attach to is required";var a={};return a.margin={top:50,right:0,bottom:30,left:0},a.width=$(t).width()-a.margin.left,a.height=800,a.xDomain=[0,0],a.yDomain=[0,0],a.elem=t,a.xAxisVisible=!0,a.yAxisVisible=!0,a.x2AxisVisible=!1,a.y2AxisVisible=!1,a.xOrient="top",a.x2Orient="bottom",a.yOrient="left",a.y2Orient="right",a.duration=500,i&&(i.margin&&(a.margin=i.margin),i.width&&(a.width=i.width),i.height&&(a.height=i.height),i.xDomain&&(a.xDomain=i.xDomain),i.yDomain&&(a.yDomain=i.yDomain)),a.setDuration=function(t){return this.duration=t,this},a.setMargin=function(t,i,n,a){return this.margin={top:t,right:i,bottom:n,left:a},this},a.setWidth=function(t){return this.width=t,this},a.setHeight=function(t){return this.height=t,this},a.setXDomain=function(t){return this.xDomain=t,this},a.setYDomain=function(t){return this.yDomain=t,this},a.setX2Domain=function(t){return this.x2Domain=t,this},a.setY2Domain=function(t){return this.y2Domain=t,this},a.toggleXAxis=function(t){return this.xAxisVisible=t,this},a.toggleX2Axis=function(t){return this.x2AxisVisible=t,this},a.toggleYAxis=function(t){return this.yAxisVisible=t,this},a.toggleY2Axis=function(t){return this.y2AxisVisible=t,this},a.setXTicks=function(t){return this.xTicks=t,this},a.setYTicks=function(t){return this.yTicks=t,this},a.setX2Ticks=function(t){return this.x2Ticks=t,this},a.setY2Ticks=function(t){return this.y2Ticks=t,this},a.setYTitle=function(t){return this.yTitle=t,this},a.setXTitle=function(t){return this.xTitle=t,this},a.setY2Title=function(t){return this.y2Title=t,this},a.setX2Title=function(t){return this.x2Title=t,this},a.setXOrient=function(t){return this.xOrient=t,this},a.setX2Orient=function(t){return this.x2Orient=t,this},a.setYOrient=function(t){return this.yOrient=t,this},a.sety2Orient=function(t){return this.y2Orient=t,this},a.setXTickFormat=function(t){return this.xTickFormat=t,this},a.setYTickFormat=function(t){return this.yTickFormat=t,this},a.setX2TickFormat=function(t){return this.x2TickFormat=t,this},a.setY2TickFormat=function(t){return this.y2TickFormat=t,this},a.draw=function(){if(this.xScale=d3.scale.linear().domain(this.xDomain).range([0,this.width]),this.yScale=d3.scale.linear().domain(this.yDomain).range([0,this.height]),this.svg=d3.select(t).append("svg").attr("class","log_plot").attr("width",this.width+this.margin.right+this.margin.left).attr("height",this.height+this.margin.bottom+this.margin.top).append("g").attr("height",this.height).attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.xAxisVisible&&(this.xAxis=n(this.xScale,-this.height,this.xOrient,this.xTicks),this.xAxis.tickFormat(this.xTickFormat),this.svg.append("g").attr("class","x axis").call(this.xAxis).selectAll("text").style("text-anchor","start").attr("transform","rotate(-45)")),this.yAxisVisible&&(this.yAxis=n(this.yScale,-this.width,this.yOrient,this.yTicks),this.yAxis.tickFormat(this.yTickFormat),this.svg.append("g").attr("class","y axis").call(this.yAxis)),this.x2AxisVisible&&(this.x2Scale=d3.scale.linear().domain(this.x2Domain).range([0,this.width]),this.x2Axis=n(this.x2Scale,-this.height,this.x2Orient,this.x2Ticks),this.x2Axis.tickFormat(this.x2TickFormat),this.svg.append("g").attr("class","x2 axis").attr("transform","translate(0,"+this.height+")").call(this.x2Axis).selectAll("text").style("text-anchor","start").attr("transform","rotate(45)")),this.y2AxisVisible&&(this.y2Scale=d3.scale.linear().domain(this.y2Domain).range([0,this.height]),this.y2Axis=n(this.y2Scale,-this.width,this.y2Orient,this.y2Ticks),this.y2Axis.tickFormat(this.y2TickFormat),this.svg.append("g").attr("class","y2 axis").attr("transform","translate("+this.width+",0)").call(this.y2Axis)),this.xTitle){if(""===this.xTickFormat)var i=-10;else var i=-30;this.svg.append("text").attr("x",this.width/2).attr("y",i).style("text-anchor","middle").text(this.xTitle)}if(this.yTitle){if(""===this.yTickFormat)var a=-10;else var a=-40;this.svg.append("text").attr("transform","rotate(-90)").attr("y",a).attr("dy","1em").style("text-anchor","end").text(this.yTitle)}return this},a.reDraw=function(t,i,n,a){t&&(this.xScale.domain(t),this.svg.select(".x.axis").transition().duration(this.duration).call(this.xAxis).ease("linear").selectAll("text").style("text-anchor","start").attr("transform","rotate(-45)")),i&&(this.yScale.domain(i),this.svg.select(".y.axis").transition().duration(this.duration).call(this.yAxis).ease("linear")),n&&(this.x2Scale.domain(n),this.svg.select(".x2.axis").transition().duration(this.duration).call(this.x2Axis).ease("linear").selectAll("text").style("text-anchor","start").attr("transform","rotate(45)")),a&&(this.y2Scale.domain(a),this.svg.select(".y2.axis").transition().duration(this.duration).call(this.y2Axis).ease("linear"))},a},g3.seismic=function(t,i){if(!i||!$.isArray(i))return"Param: data is missing, An array required";if(!t)return"Param: plot is missing, a div to attach the svg is required";var n={};return n.max=1,n.gain=1,n.plot=t,n.data=i,n.duration=500,n.draw=function(){return n.color=d3.scale.linear().domain([-this.max,0,this.max]).range(["#FF0000","#FFF","#0000FF"]),$(t.elem),this.canvas=d3.select(t.elem).append("canvas").attr("width",i.length).attr("height",i[0].length).style("width",t.width+"px").style("height",t.height+"px").style("opacity",.95).style("top",t.margin.top+"px").style("left",t.margin.left+"px").call(n.drawImage),this},n.reDraw=function(t){n.canvas.attr("width",t.length).attr("height",t[0].length).style("width",n.plot.width+"px").style("height",n.plot.height+"px"),n.context.clearRect(0,0,n.data.length,n.data[0].length),n.data=t;for(var i=t.length,a=t[0].length,r=n.context.createImageData(i,a),e=0,s=-1;a>e;++e)for(var h=0;i>h;++h){var o=d3.rgb(n.color(t[h][e]));r.data[++s]=o.r,r.data[++s]=o.g,r.data[++s]=o.b,r.data[++s]=255}return n.context.putImageData(r,0,0),this},n.drawImage=function(t){n.context=t.node().getContext("2d");var i=n.data.length,a=n.data[0].length;n.image=n.context.createImageData(i,a);for(var r=0,e=-1;a>r;++r)for(var s=0;i>s;++s){var h=d3.rgb(n.color(n.data[s][r]));n.image.data[++e]=h.r,n.image.data[++e]=h.g,n.image.data[++e]=h.b,n.image.data[++e]=255}return n.context.putImageData(n.image,0,0),this},n.setDuration=function(t){return this.duration=t,this},n.setMax=function(t){return this.max=t,this},n.setGain=function(t){return this.gain=t,this},n},g3.wiggle=function(t,i,n){if(!i||!$.isArray(i))return"Param: data is missing, An array required";if(!t)return"Param: plot is missing, a div to attach the svg is required";var a={};return a.skip=0,a.gain=30,a.xInt=1,a.xMin=t.xDomain[0],a.yInt=1,a.yMin=t.yDomain[0],a.rand=Math.floor(100*Math.random()+1),a.sampleRate=1,a.duration=500,n&&(n.skip&&(a.skip=n.skip),n.gain&&(a.gain=n.gain),n.xMin&&(a.xMin=n.xMin),n.xMin&&(a.xInt=n.xInt),n.yMin&&(a.yMin=n.yMin),n.yInt&&(a.yInt=n.yInt),n.max&&(a.max=n.max)),a.gain/a.max,a.setSkip=function(t){return this.skip=t,this},a.setGain=function(t){return this.gain=t,this},a.setMax=function(t){return this.max=t,this},a.setXMin=function(t){return this.xMin=t,this},a.setYMin=function(t){return this.yMin=t,this},a.setXInt=function(t){return this.xInt=t,this},a.setYInt=function(t){return this.yInt=t,this},a.setFillColor=function(t){return this.fillColor=t,this},a.setColor=function(t){return this.color=t,this},a.setStrokeWidth=function(t){return this.strokeWidth=t,this},a.setSampleRate=function(t){return this.sampleRate=t,this},a.setDuration=function(t){return this.duration=t,this},a.draw=function(){for(var n=i.length-1;n>=0;n--)if(0===this.skip||0===n%this.skip){var r=d3.mean(i[n]),e=d3.svg.area().interpolate("basis").x(function(i){return t.xScale(i*a.gain+a.xMin+n*a.sampleRate)}).y(function(i,n){return t.yScale(n*a.yInt+a.yMin)}),s=d3.svg.area().interpolate("basis").x(function(){return t.xScale(r*a.gain+a.xMin+n*a.sampleRate)}).y(function(i,n){return t.yScale(n*a.yInt+a.yMin)});t.svg.append("path").attr("class","line"+n).attr("d",e(i[n])).attr("stroke","black").attr("stroke-width",.25).attr("fill","none"),t.svg.datum(i[n]),t.svg.append("clipPath").attr("id","clip-below"+a.rand+n).append("path").attr("d",s.x0(t.width)),t.svg.append("path").attr("id","area-below"+n).attr("clip-path","url(#clip-below"+a.rand+n).attr("fill","grey").attr("d",s.x0(function(i){return t.xScale(i*a.gain+a.xMin+n*a.sampleRate)}))}return this},a.reDraw=function(i,n,r){t.xScale.domain(n),t.yScale.domain(r),t.svg.select(".x.axis").transition().duration(this.duration).call(t.xAxis).selectAll("text").style("text-anchor","start").attr("transform","rotate(-45)"),t.svg.select(".y.axis").transition().duration(this.duration).call(t.yAxis);for(var e=i.length-1;e>=0;e--)if(0===this.skip||0===e%this.skip){var s=d3.mean(i[e]);t.svg.select("#clip-below"+a.rand+e).remove();var h=d3.svg.area().interpolate("basis").x(function(i){return t.xScale(i*a.gain+a.xMin+e*a.sampleRate)}).y(function(i,n){return t.yScale(n*a.yInt+a.yMin)}),o=d3.svg.area().interpolate("basis").x(function(){return t.xScale(s*a.gain+a.xMin+e*a.sampleRate)}).y(function(i,n){return t.yScale(n*a.yInt+a.yMin)});t.svg.select(".line"+e).transition().duration(this.duration).attr("d",h(i[e])).ease("linear"),t.svg.datum(i[e]),t.svg.append("clipPath").attr("id","clip-below"+a.rand+e).append("path").attr("d",o.x0(t.width)),t.svg.select("#area-below"+e).attr("clip-path","url(#clip-below"+a.rand+e).transition().duration(this.duration).attr("d",o.x0(function(i){return t.xScale(i*a.gain+a.xMin+e*a.sampleRate)})).ease("linear")}return this},a}})(window);